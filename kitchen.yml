---
driver:
  name: azurerm
  subscription_id: 1e0b427a-d58b-494e-ae4f-ee558463ebbf
  location: West Europe
  machine_size: Standard_D1

transport:
  ssh_key: ~/.ssh/id-kitchen-azurerm

provisioner:
  name: chef_zero

verifier:
  name: inspec

platforms:
  - name: ubuntu-18.04
    driver:
      image_urn: Canonical:UbuntuServer:18.04-LTS:latest
      vm_name: camsa-setup-test
      vm_tags:
        description: CAMSA Setup cookbook testing

suites:
  - name: automate
    # Add lifecycle hook to handle the setup of the hosts file
    # This configures the necessary alias to contact the local Automate instance to
    # obtain a trial license
    lifecycle:
      post_create:
      - remote: sudo sh -c 'echo "127.0.0.1 automate-gateway" >> /etc/hosts'
    provisioner:
      policyfile: policyfiles/automate.rb